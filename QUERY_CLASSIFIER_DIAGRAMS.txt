"""
Visual Diagrams & System Architecture for Query Classifier
Generated as ASCII art and structured documentation
"""

# ============================================================================
# CLASSIFICATION DECISION TREE
# ============================================================================

"""
                            User Query
                                |
                                v
                    ┌───────────────────────┐
                    │  QueryClassifier      │
                    │  .classify(query)     │
                    └───────────┬───────────┘
                                |
                    ┌───────────┴──────────────┐
                    |                          |
                  NO API KEY            API KEY CONFIGURED
                    |                          |
                    v                          v
            ┌──────────────────┐      ┌──────────────────┐
            │ HEURISTIC MODE   │      │ AI MODE (via API)│
            │ (Fast, Offline)  │      │ (Accurate, Cloud)│
            └────────┬─────────┘      └────────┬─────────┘
                     |                          |
                     v                          v
            [Keyword Matching]         [LLM Classification]
                     |                          |
                     └──────────┬───────────────┘
                                |
                    ┌───────────v──────────┐
                    │ Classification      │
                    │ {                   │
                    │  type: str,         │
                    │  confidence: 0-1,   │
                    │  reasoning: str,    │
                    │  keywords: list,    │
                    │  needs_*: bool      │
                    │ }                   │
                    └───────────┬─────────┘
                                |
                ┌───────────────┼───────────────┐
                |               |               |
                v               v               v
            GENERAL         REALTIME        AUTOMATION
           Query Type       Query Type      Query Type
                |               |               |
                v               v               v
            ┌─────────┐    ┌──────────┐   ┌──────────┐
            │  _handle│    │_handle   │   │_handle   │
            │_general │    │_realtime │   │_automation
            │         │    │          │   │          │
            │ • LLM   │    │ • Web    │   │ • Skills │
            │ • Chat  │    │ • Search │   │ • Intent │
            │ • Know  │    │ • LLM    │   │ • Command
            │ • Edge  │    │ • Latest │   │ • Actions
            └────┬────┘    └────┬─────┘   └────┬─────┘
                 |               |              |
                 └───────────┬───┴──────────────┘
                             |
                             v
                        Response
                        to User
"""

# ============================================================================
# QUERY TYPE CHARACTERISTICS
# ============================================================================

"""
┌─────────────────────────────────────────────────────────────────────────┐
│                    QUERY TYPE CLASSIFICATION MATRIX                      │
├──────────────┬──────────────────┬──────────────────┬────────────────────┤
│   Category   │     General      │    Real-time     │    Automation      │
├──────────────┼──────────────────┼──────────────────┼────────────────────┤
│ Purpose      │ Conversational,  │ Current info,    │ System control,    │
│              │ Knowledge        │ Live data        │ Action execution   │
├──────────────┼──────────────────┼──────────────────┼────────────────────┤
│ Key Traits   │ Static knowledge │ Time-sensitive   │ Command-oriented   │
│              │ No urgency       │ Factual/dynamic  │ Action-focused     │
├──────────────┼──────────────────┼──────────────────┼────────────────────┤
│ Examples     │ "How are you?"   │ "Weather?"       │ "Open Spotify"     │
│              │ "What is AI?"    │ "Bitcoin price"  │ "Set reminder"     │
│              │ "Tell joke"      │ "Latest news"    │ "Send email"       │
├──────────────┼──────────────────┼──────────────────┼────────────────────┤
│ Processing   │ LLM directly     │ Web search + LLM │ Intent parsing +   │
│              │ No internet      │ Requires web     │ Skill execution    │
├──────────────┼──────────────────┼──────────────────┼────────────────────┤
│ Speed        │ ⚡⚡⚡ Very fast │ ⚡⚡ Medium       │ ⚡ Variable        │
├──────────────┼──────────────────┼──────────────────┼────────────────────┤
│ Confidence   │ Usually High     │ Medium-High      │ Usually High       │
│              │ (~90%)           │ (~85%)           │ (~90%)             │
└──────────────┴──────────────────┴──────────────────┴────────────────────┘
"""

# ============================================================================
# KEYWORD FLOW
# ============================================================================

"""
                    QUERY INPUT
                        |
                        v
            ┌───────────────────────┐
            │  Extract Keywords     │
            └───────────┬───────────┘
                        |
        ┌───────────────┼───────────────┐
        |               |               |
        v               v               v
    AUTOMATION       REALTIME        GENERAL
    Keywords         Keywords        (Default)
        |               |
        v               v
    ├─ open        ├─ weather
    ├─ close       ├─ price
    ├─ play        ├─ who is
    ├─ search      ├─ what is
    ├─ take        ├─ latest
    ├─ delete      ├─ current
    ├─ send        ├─ today
    ├─ remind      └─ now
    ├─ set
    ├─ turn
    ├─ create
    └─ generate
"""

# ============================================================================
# PRIORITY DECISION LOGIC (HEURISTIC MODE)
# ============================================================================

"""
                        Query Keywords?
                             |
                    ┌────────┴────────┐
                    NO               YES
                    |                 |
                    v                 v
                DEFAULT          Check for:
                (GENERAL)             |
                 0.7              ┌───┴────┐
                                  |        |
                                  v        v
                            AUTOMATION  REALTIME
                            Keywords?   Keywords?
                                |        |
                           YES  |        |
                            |   |    NO  |
                            v   v        v
                        PRIMARY SECONDARY
                        MATCH   MATCH
                        
                    No match → Default to GENERAL

        Priority: AUTOMATION > REALTIME > GENERAL
"""

# ============================================================================
# CONFIDENCE SCORING
# ============================================================================

"""
Confidence Interpretation:

   1.0 ┃
       ┃ ████████ High Confidence (>0.85)
   0.85┃ ████████ Use for routing
       ┃ ████████
   0.70┃ ▒▒▒▒▒▒▒▒ Medium Confidence (0.70-0.85)
       ┃ ▒▒▒▒▒▒▒▒ Review results
       ┃ ▒▒▒▒▒▒▒▒
   0.50┃ ░░░░░░░░ Low Confidence (<0.70)
       ┃ ░░░░░░░░ Ask for clarification
       ┃ ░░░░░░░░
   0.0 ┃

AI Mode:     ~0.95 average (very reliable)
Heuristic:   ~0.75 average (good enough)
"""

# ============================================================================
# REQUEST ROUTING FLOW
# ============================================================================

"""
                    classify_and_respond(query)
                            |
                            v
                    classifier.classify(query)
                            |
        ┌───────────────────┼───────────────────┐
        |                   |                   |
        v                   v                   v
    GENERAL             REALTIME            AUTOMATION
        |                   |                   |
        v                   v                   v
   _handle_         _handle_              _handle_
   general()        realtime()            automation()
        |                   |                   |
        v                   v                   v
    LLM API         Web Search         Skill
    (OpenRouter)      + LLM             Executor
        |                   |                   |
        v                   v                   v
    "Chat            "Current        "Action
    Response"         Info"          Complete"
        |                   |                   |
        └───────────────────┼───────────────────┘
                            |
                            v
                        Final Response
                        to User
"""

# ============================================================================
# STATE TRANSITIONS
# ============================================================================

"""
                    START
                     |
                     v
            ┌─────────────────┐
            │ Receive Query   │
            └────────┬────────┘
                     |
                     v
            ┌─────────────────┐
            │ Classify Type   │◄─── Can update via feedback
            └────────┬────────┘
                     |
        ┌────────────┼────────────┐
        |            |            |
        v            v            v
    GENERAL      REALTIME    AUTOMATION
        |            |            |
        |            |            v
        |            |       ┌─────────────┐
        |            |       │Execute Skill│
        |            |       └────────┬────┘
        |            |               |
        |            v               |
        |    ┌───────────────┐       |
        |    │ Search Web   │       |
        |    └───────┬───────┘       |
        |            |               |
        v            v               v
        └────┬───────┴───────┬───────┘
             |               |
             v               v
         Use LLM ──────► Refine/Format
             |               |
             └───────┬───────┘
                     |
                     v
             ┌──────────────────┐
             │ Return Response  │
             └────────┬─────────┘
                      |
                      v
                    END
"""

# ============================================================================
# ERROR HANDLING FLOW
# ============================================================================

"""
            Try Classify
                 |
        ┌────────┴────────┐
        |                 |
      NO ERROR          ERROR
        |                 |
        v                 v
    Continue      Fallback to
    with Result   Heuristic
        |                 |
        |                 v
        |            Use Keywords
        |                 |
        |        ┌────────┴────────┐
        |        |                 |
        |      SUCCESS           FAIL
        |        |                 |
        |        v                 v
        |    Continue         DEFAULT:
        |    with Result      GENERAL
        |        |                 |
        └────────┴─────────────────┘
                  |
                  v
        Continue Routing
"""

# ============================================================================
# USAGE EXAMPLES BY SCENARIO
# ============================================================================

"""
SCENARIO 1: Simple Query
─────────────────────────
User: "How are you?"
       ↓
   Classifier: GENERAL (confidence 0.95)
       ↓
   _handle_general(query)
       ↓
   Response: "I'm doing great, thanks for asking!"


SCENARIO 2: Information Query
──────────────────────────────
User: "Who is Elon Musk?"
       ↓
   Classifier: REALTIME (confidence 0.92)
       ↓
   _handle_realtime(query)
       ├─ Search web for "Elon Musk"
       ├─ Get latest info
       └─ Process with LLM
       ↓
   Response: "Elon Musk is a South African-born entrepreneur..."


SCENARIO 3: Command Query
──────────────────────────
User: "Open Spotify"
       ↓
   Classifier: AUTOMATION (confidence 0.98)
       ↓
   _handle_automation(query)
       ├─ Parse intent → "open_app"
       ├─ Extract params → "Spotify"
       └─ Execute skill
       ↓
   Response: "Opening Spotify now..."
"""

# ============================================================================
# INTEGRATION POINTS
# ============================================================================

"""
Your Application
     |
     v
┌──────────────────────┐
│ response.py / brain  │
│ (Main handler)       │
└────────┬─────────────┘
         |
         v
┌──────────────────────────────┐
│ classify_and_respond()       │
│ (Integration function)       │
└────────┬─────────────────────┘
         |
         v
┌──────────────────────────────┐
│ QueryRouter.route()          │
│ (Routing logic)              │
└────────┬─────────────────────┘
         |
         v
┌──────────────────────────────┐
│ QueryClassifier.classify()   │
│ (Classification engine)      │
└────────┬─────────────────────┘
         |
    ┌────┴────┐
    |         |
    v         v
  AI API   Heuristic
  Mode      Mode
    |         |
    └────┬────┘
         |
         v
    Classification
    Result
"""

# ============================================================================
# CONFIGURATION LEVELS
# ============================================================================

"""
LEVEL 0: Minimal (Out of box)
   └─ Use heuristic mode (no config needed)
   └─ ~70% accuracy
   └─ No internet required

LEVEL 1: Basic (Add API key)
   ├─ Configure OPENROUTER_API_KEY
   ├─ Enable AI classification
   └─ ~95% accuracy

LEVEL 2: Advanced (Custom handlers)
   ├─ Register custom handlers
   ├─ Add logging/monitoring
   └─ Custom confidence thresholds

LEVEL 3: Enterprise (Full customization)
   ├─ Multiple classification models
   ├─ A/B testing different classifiers
   ├─ User feedback loop
   └─ Continuous improvement
"""
